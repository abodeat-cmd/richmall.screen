<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>بث أسعار الذهب - تحديث برمجي</title>
    <style>
        body {
            margin: 0; padding: 0; background-color: #ffffff; color: #333;
            font-family: 'Segoe UI', Arial, sans-serif;
            overflow: hidden; width: 2816px; height: 384px; display: flex; align-items: center;
        }
        .container {
            display: grid; grid-template-columns: 450px 1.2fr 1fr 1fr 1fr 1.2fr;
            width: 100%; height: 100%; align-items: center; text-align: center;
        }
        .logo-section { border-left: 2px solid #eee; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #fdfdfd; }
        .logo-img { max-width: 300px; max-height: 200px; object-fit: contain; }
        .price-card { padding: 10px; border-left: 1px solid #f0f0f0; height: 85%; display: flex; flex-direction: column; justify-content: center; }
        .label { font-size: 34px; color: #777; margin-bottom: 10px; font-weight: bold; }
        .value { font-size: 75px; font-weight: 900; color: #b8860b; letter-spacing: -1px; }
        .unit { font-size: 28px; color: #444; margin-right: 10px; font-weight: normal; }
        .live-dot { width: 14px; height: 14px; background: #2ecc71; border-radius: 50%; display: inline-block; margin-left: 10px; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }
        #clock { font-size: 65px; font-weight: 900; color: #222; }
        #date { font-size: 28px; color: #b8860b; margin-bottom: 5px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="container">
        <div class="logo-section">
            <img src="logo.png" alt="logo" class="logo-img" onerror="this.style.display='none'">
            <div style="font-size: 22px; color: #2ecc71; margin-top: 15px; font-weight: bold;">
                <span class="live-dot"></span> مباشر الآن
            </div>
        </div>

        <div class="price-card">
            <div class="label">الأونصة عالمياً</div>
            <div class="value" id="ounce-price">...</div>
        </div>

        <div class="price-card">
            <div class="label">جرام عيار 24</div>
            <div class="value" id="gold-24">...</div>
        </div>

        <div class="price-card">
            <div class="label">جرام عيار 21</div>
            <div class="value" id="gold-21">...</div>
        </div>

        <div class="price-card">
            <div class="label">جرام عيار 18</div>
            <div class="value" id="gold-18">...</div>
        </div>

        <div class="price-card" style="border: none; background: #fafafa;">
            <div id="date"></div>
            <div id="clock"></div>
        </div>
    </div>

    <script>
        const API_KEY = 'goldapi-a2wgr19mgvr64c3-io'; 
        
        async function fetchGoldPrices() {
            try {
                // طلب السعر العالمي بالأونصة أولاً
                const response = await fetch(`https://www.goldapi.io/api/XAU/USD`, {
                    headers: { "x-access-token": API_KEY }
                });
                const data = await response.json();

                if(data.price) {
                    const priceUSD = data.price; // سعر الأونصة بالدولار
                    const sarRate = 3.75; // سعر صرف الريال الثابت
                    
                    // حساب سعر الجرام يدوياً لضمان الدقة
                    // الأونصة = 31.1034768 جرام
                    const priceGram24_SAR = (priceUSD / 31.1034768) * sarRate;
                    const priceGram21_SAR = priceGram24_SAR * (21/24);
                    const priceGram18_SAR = priceGram24_SAR * (18/24);

                    // تحديث الشاشة
                    document.getElementById('ounce-price').innerHTML = `<span class="unit">$</span>${priceUSD.toLocaleString(undefined, {minimumFractionDigits: 2})}`;
                    document.getElementById('gold-24').innerHTML = `${priceGram24_SAR.toFixed(2)}<span class="unit">ر.س</span>`;
                    document.getElementById('gold-21').innerHTML = `${priceGram21_SAR.toFixed(2)}<span class="unit">ر.س</span>`;
                    document.getElementById('gold-18').innerHTML = `${priceGram18_SAR.toFixed(2)}<span class="unit">ر.س</span>`;
                } else {
                    console.log("البيانات غير متوفرة حالياً");
                }
            } catch (error) {
                console.error("خطأ في الاتصال بالمصدر");
            }
        }

        function updateClock() {
            const now = new Date();
            document.getElementById('clock').textContent = now.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            document.getElementById('date').textContent = now.toLocaleDateString('ar-SA', { day: 'numeric', month: 'long', year: 'numeric' });
        }

        // تحديث كل 5 دقائق لضمان دقة البيانات
        setInterval(fetchGoldPrices, 300000); 
        setInterval(updateClock, 1000);
        
        fetchGoldPrices();
        updateClock();
    </script>
</body>
</html>